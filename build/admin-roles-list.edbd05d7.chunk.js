"use strict";(self.webpackChunkserver=self.webpackChunkserver||[]).push([[3455],{98906:(H,j,t)=>{t.r(j),t.d(j,{default:()=>me});var e=t(67294),s=t(64289),f=t(87751),O=t(65186),R=t(4585),Z=t(20022),x=t(96315),I=t(185),A=t(53979),u=t(29728),v=t(36989),g=t(49066),S=t(38939),F=t(49386),G=t(8060),Q=t(79031),C=t(37909),W=t(75515),J=t(63237),Y=t(15234),k=t(27361),w=t.n(k),$=t(86896),q=t(16550),_=t(48474);const ee=()=>"todo empty role";var te=t(45697),B=t.n(te),ne=t(11047),le=t(41580),se=t(12028);const N=({id:o,name:a,description:n,usersCount:h,icons:r,rowIndex:m,canUpdate:p})=>{const{formatMessage:T}=(0,$.Z)(),[,i]=r,M=T({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:h});return e.createElement(Q.Tr,{"aria-rowindex":m,key:o,...p?(0,s.X7)({fn:i.onClick}):{}},e.createElement(C.Td,{maxWidth:(0,s.Q1)(130)},e.createElement(W.Z,{ellipsis:!0,textColor:"neutral800"},a)),e.createElement(C.Td,{maxWidth:(0,s.Q1)(250)},e.createElement(W.Z,{ellipsis:!0,textColor:"neutral800"},n)),e.createElement(C.Td,null,e.createElement(W.Z,{textColor:"neutral800"},M)),e.createElement(C.Td,null,e.createElement(ne.k,{justifyContent:"flex-end",...s.UW},r.map((d,P)=>d?e.createElement(le.x,{key:d.label,paddingLeft:P===0?0:1},e.createElement(se.h,{onClick:d.onClick,label:d.label,noBorder:!0,icon:d.icon})):null))))};N.propTypes={id:B().number.isRequired,name:B().string.isRequired,description:B().string.isRequired,usersCount:B().number.isRequired,icons:B().array.isRequired,rowIndex:B().number.isRequired,canUpdate:B().bool},N.defaultProps={canUpdate:!1};const oe=N;var ae=t(18172);const re={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},ie=(o,a)=>(0,ae.ZP)(o,n=>{switch(a.type){case"ON_REMOVE_ROLES":{n.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{n.shouldRefetchData=!0,n.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{n.shouldRefetchData=!1,n.roleToDelete=null,n.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{n.roleToDelete=a.id;break}default:return n}}),de=()=>{(0,s.go)();const{locale:o}=(0,$.Z)(),{isLoading:a,allowedActions:{canCreate:n,canDelete:h,canRead:r,canUpdate:m}}=(0,s.ss)(f.Z.settings.roles),{getData:p,roles:T,isLoading:i}=(0,_.bF)(!1),[{query:M}]=(0,s.Kx)(),d=M?._q||"",{includes:P}=(0,s.L0)(o,{sensitivity:"base"}),y=(0,s.Xe)(o,{sensitivity:"base"}),U=(T||[]).filter(D=>P(D.name,d)||P(D.description,d)).sort((D,L)=>y.compare(D.name,L.name)||y.compare(D.description,L.description));return(0,e.useEffect)(()=>{!a&&r&&p()},[a,r,p]),{isLoadingForPermissions:a,canCreate:n,canDelete:h,canRead:r,canUpdate:m,isLoading:i,getData:p,sortedRoles:U,roles:T}},ce=({getData:o,canCreate:a,canDelete:n,canUpdate:h})=>{const{formatMessage:r}=(0,$.Z)(),m=(0,s.lm)(),[p,T]=(0,e.useState)(!1),{push:i}=(0,q.k6)(),[{selectedRoles:M,showModalConfirmButtonLoading:d,roleToDelete:P},y]=(0,e.useReducer)(ie,re),{post:U}=(0,s.tg)(),D=async()=>{try{y({type:"ON_REMOVE_ROLES"}),await U("/admin/roles/batch-delete",{ids:[P]}),await o(),y({type:"RESET_DATA_TO_DELETE"})}catch(l){const c=w()(l,["response","payload","data","ids"],null);if(c&&Array.isArray(c)){const ge=c.join(`
`);m({type:"warning",message:ge})}else m({type:"warning",message:{id:"notification.error"}})}E()},L=(0,e.useCallback)(l=>{i(`/settings/roles/duplicate/${l}`)},[i]),V=()=>i("/settings/roles/new"),K=(0,e.useCallback)(l=>{y({type:"SET_ROLE_TO_DELETE",id:l}),E()},[]),E=()=>T(l=>!l),b=(0,e.useCallback)(l=>{i(`/settings/roles/${l}`)},[i]),z=(0,e.useCallback)((l,c)=>{l.preventDefault(),l.stopPropagation(),c.usersCount?m({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):K(c.id)},[m,K]),X=(0,e.useCallback)((l,c)=>{l.preventDefault(),l.stopPropagation(),L(c.id)},[L]),Ee=(0,e.useCallback)(l=>[...a?[{onClick:c=>X(c,l),label:r({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(O.Z,null)}]:[],...h?[{onClick:()=>b(l.id),label:r({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(R.Z,null)}]:[],...n?[{onClick:c=>z(c,l),label:r({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Z.Z,null)}]:[]],[r,z,X,b,a,h,n]);return{handleNewRoleClick:V,getIcons:Ee,selectedRoles:M,isWarningDeleteAllOpened:p,showModalConfirmButtonLoading:d,handleToggleModal:E,handleDeleteData:D}},ue=()=>{const{formatMessage:o}=(0,$.Z)(),{isLoadingForPermissions:a,canCreate:n,canRead:h,canDelete:r,canUpdate:m,isLoading:p,getData:T,sortedRoles:i}=de(),{handleNewRoleClick:M,getIcons:d,isWarningDeleteAllOpened:P,showModalConfirmButtonLoading:y,handleToggleModal:U,handleDeleteData:D}=ce({getData:T,canCreate:n,canDelete:r,canUpdate:m}),L=i.length+1,V=6;if(a)return e.createElement(I.o,null,e.createElement(s.dO,null));const K=o({id:"global.roles",defaultMessage:"roles"});return e.createElement(I.o,null,e.createElement(s.SL,{name:"Roles"}),e.createElement(A.T,{primaryAction:n?e.createElement(u.z,{onClick:M,startIcon:e.createElement(x.Z,null),size:"S"},o({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:K,subtitle:o({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),h&&e.createElement(v.Z,{startActions:e.createElement(s.m,{label:o({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:K})})}),h&&e.createElement(g.D,null,e.createElement(S.i,{colCount:V,rowCount:L,footer:n?e.createElement(F.c,{onClick:M,icon:e.createElement(x.Z,null)},o({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(G.h,null,e.createElement(Q.Tr,{"aria-rowindex":1},e.createElement(C.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},o({id:"global.name",defaultMessage:"Name"}))),e.createElement(C.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},o({id:"global.description",defaultMessage:"Description"}))),e.createElement(C.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},o({id:"global.users",defaultMessage:"Users"}))),e.createElement(C.Th,null,e.createElement(J.T,null,o({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(Y.p,null,i?.map((E,b)=>e.createElement(oe,{key:E.id,id:E.id,name:E.name,description:E.description,usersCount:E.usersCount,icons:d(E),rowIndex:b+2,canUpdate:m})))),!L&&!p&&e.createElement(ee,null)),e.createElement(s.QH,{isOpen:P,onConfirm:D,isConfirmButtonLoading:y,onToggleDialog:U}))},me=()=>e.createElement(s.O4,{permissions:f.Z.settings.roles.main},e.createElement(ue,null))},36989:(H,j,t)=>{t.d(j,{Z:()=>A});var e=t(85893),s=t(67294),f=t(45697),O=t(1565),R=t(11047),Z=t(41580);const x=(0,O.ZP)(R.k)`
  & > * + * {
    margin-left: ${({theme:u})=>u.spaces[2]};
  }

  margin-left: ${({pullRight:u})=>u?"auto":void 0};
`,I=(0,O.ZP)(x)`
  flex-shrink: 0;
`,A=({startActions:u,endActions:v})=>u||v?(0,e.jsx)(Z.x,{paddingLeft:10,paddingRight:10,children:(0,e.jsx)(Z.x,{paddingBottom:4,children:(0,e.jsxs)(R.k,{justifyContent:"space-between",alignItems:"flex-start",children:[u&&(0,e.jsx)(x,{wrap:"wrap",children:u}),v&&(0,e.jsx)(I,{pullRight:!0,children:v})]})})}):null;A.defaultProps={endActions:void 0,startActions:void 0},A.propTypes={endActions:f.node,startActions:f.node}},49386:(H,j,t)=>{t.d(j,{c:()=>v});var e=t(85893),s=t(67294),f=t(45697),O=t(1565),R=t(41580),Z=t(70004),x=t(11047),I=t(75515);const A=(0,O.ZP)(R.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:g})=>g.colors.primary600};
  }
`,u=(0,O.ZP)(R.x)`
  border-radius: 0 0 ${({theme:g})=>g.borderRadius} ${({theme:g})=>g.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,v=({children:g,icon:S,...F})=>(0,e.jsxs)("div",{children:[(0,e.jsx)(Z.i,{}),(0,e.jsx)(u,{as:"button",background:"primary100",padding:5,...F,children:(0,e.jsxs)(x.k,{children:[(0,e.jsx)(A,{"aria-hidden":!0,background:"primary200",children:S}),(0,e.jsx)(R.x,{paddingLeft:3,children:(0,e.jsx)(I.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:g})})]})})]});v.propTypes={children:f.string.isRequired,icon:f.node.isRequired}}}]);
